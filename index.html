<!DOCTYPE html>
<html>
<head>
  <title>Main Page</title>
</head>
<body>
  <h1>HTML to PDF via New Tab</h1>
  <div id="content">
    <h2>Invoice</h2>
    <p>This is a sample invoice generated via a new tab.</p>
    <input type="text" />
  </div>
  <button onclick="openPDFTab()">Generate PDF</button>

  <script>
    function openPDFTab() {
      const content = document.getElementById("content").innerHTML;
      const pdfTab = window.open("pdf-generator.html", "_blank");

      // Wait until the tab is ready to receive the message
      const interval = setInterval(() => {
        if (pdfTab && pdfTab.document.readyState === 'complete') {
          clearInterval(interval);
          pdfTab.postMessage({ html: content }, "*");
        }
      }, 200);
    }
  </script>
</body>
</html>
